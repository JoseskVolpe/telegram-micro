This contains code copied in large part from Bouncycastle because I couldn't be asked.  
It still needs to be majorly cut down.
